{
  "project": "Claude History Search",
  "spec": "artifacts/spec.json",
  "prd": "artifacts/prd.json",
  "phases": [
    {
      "id": "phase-1",
      "name": "Foundation & Core Infrastructure",
      "type": "sequential",
      "gate": "Project structure established, schemas validated, basic TUI framework functional",
      "worktrees": false,
      "tracks": [
        {
          "id": "track-foundation",
          "branch": "dev/phase-1-foundation",
          "parallel": false,
          "agents": [
            {
              "id": "agent-project-scaffolding-and-depend",
              "stories": [
                "US-001"
              ],
              "files": [
                "pyproject.toml",
                "src/__init__.py",
                "README.md"
              ],
              "dependsOn": [],
              "task": "Set up Python package structure for Claude History Search. Package installs via pipx. Basic directory structure created. Dependencies configured",
              "verification": [
                "Package installs via pipx",
                "Basic directory structure created",
                "Dependencies configured"
              ],
              "completionPromise": "PROJECT COMPLETE: Project scaffolding and dependencies",
              "complete": false
            }
          ]
        }
      ]
    },
    {
      "id": "phase-2",
      "name": "Execution Engine & Orchestration",
      "type": "sequential",
      "gate": "Execution engine functional, parallel agents working, git worktrees managed, progress tracked",
      "worktrees": false,
      "tracks": [
        {
          "id": "track-foundation",
          "branch": "phase-2/foundation",
          "parallel": true,
          "agents": [
            {
              "id": "agent-search-returns-relevant-conver",
              "stories": [
                "US-002"
              ],
              "files": [
                "src/main.py"
              ],
              "dependsOn": [
                "US-001"
              ],
              "task": "Implement Search returns relevant conversations within 2 seconds. Search returns relevant conversations within 2 seconds. All tests pass. Documentation updated",
              "verification": [
                "Search returns relevant conversations within 2 seconds",
                "All tests pass",
                "Documentation updated"
              ],
              "completionPromise": "SEARCH COMPLETE: Search returns relevant conversations within 2 sec",
              "complete": false
            },
            {
              "id": "agent-can-find-conversations-by-topi",
              "stories": [
                "US-003"
              ],
              "files": [
                "src/main.py"
              ],
              "dependsOn": [
                "US-001"
              ],
              "task": "Implement Can find conversations by topic or natural language query. Can find conversations by topic or natural language query. All tests pass. Documentation updated",
              "verification": [
                "Can find conversations by topic or natural language query",
                "All tests pass",
                "Documentation updated"
              ],
              "completionPromise": "CAN COMPLETE: Can find conversations by topic or natural languag",
              "complete": false
            },
            {
              "id": "agent-supports-at-least-1000-convers",
              "stories": [
                "US-004"
              ],
              "files": [
                "src/main.py"
              ],
              "dependsOn": [
                "US-001"
              ],
              "task": "Implement Supports at least 1000 conversation files. Supports at least 1000 conversation files. All tests pass. Documentation updated",
              "verification": [
                "Supports at least 1000 conversation files",
                "All tests pass",
                "Documentation updated"
              ],
              "completionPromise": "SUPPORTS COMPLETE: Supports at least 1000 conversation files",
              "complete": false
            },
            {
              "id": "agent-results-show-conversation-summ",
              "stories": [
                "US-005"
              ],
              "files": [
                "src/main.py"
              ],
              "dependsOn": [
                "US-001"
              ],
              "task": "Implement Results show conversation summary and relevance score. Results show conversation summary and relevance score. All tests pass. Documentation updated",
              "verification": [
                "Results show conversation summary and relevance score",
                "All tests pass",
                "Documentation updated"
              ],
              "completionPromise": "RESULTS COMPLETE: Results show conversation summary and relevance sc",
              "complete": false
            }
          ]
        }
      ]
    },
    {
      "id": "phase-3",
      "name": "Testing, Documentation & Dogfooding",
      "type": "sequential",
      "gate": "Test coverage >80%, documentation complete, dogfooding validates workflow",
      "worktrees": false,
      "tracks": [
        {
          "id": "track-testing",
          "branch": "phase-3/testing",
          "parallel": false,
          "agents": [
            {
              "id": "agent-comprehensive-test-suite",
              "stories": [
                "US-006"
              ],
              "files": [
                "tests/test_main.py"
              ],
              "dependsOn": [
                "US-001",
                "US-002",
                "US-003"
              ],
              "task": "Create test suite covering all features. Unit tests for all modules. Integration tests. Test coverage >80%",
              "verification": [
                "Unit tests for all modules",
                "Integration tests",
                "Test coverage >80%"
              ],
              "completionPromise": "COMPREHENSIVE COMPLETE: Comprehensive test suite",
              "complete": false
            }
          ]
        }
      ]
    }
  ],
  "completionCriteria": [
    {
      "id": "CC-001",
      "description": "All 6 user stories complete with acceptance criteria met",
      "met": false
    },
    {
      "id": "CC-002",
      "description": "All acceptance tests pass in CI pipeline",
      "met": false
    },
    {
      "id": "CC-003",
      "description": "Test coverage exceeds 80% for core modules",
      "met": false
    },
    {
      "id": "CC-004",
      "description": "ralph-tui installs via pipx and all workflows functional",
      "met": false
    },
    {
      "id": "CC-005",
      "description": "Dogfooding phase completed successfully with at least one phase executed using Ralph TUI itself",
      "met": false
    },
    {
      "id": "CC-006",
      "description": "Documentation complete and reviewed",
      "met": false
    },
    {
      "id": "CC-007",
      "description": "GitHub Actions workflows validated and functional",
      "met": false
    }
  ],
  "risks": [
    {
      "risk": "Claude CLI availability and rate limits during parallel execution",
      "mitigation": "Implement retry logic with exponential backoff, respect rate limits, provide clear error messages to users"
    },
    {
      "risk": "Git worktree merge conflicts when consolidating parallel tracks",
      "mitigation": "Careful file path estimation per story, phase gate review before merging, merge preview UI, rollback capability"
    },
    {
      "risk": "Completion promise detection false positives/negatives",
      "mitigation": "Multi-signal detection with confidence scoring, manual override option, iteration limit fallback"
    },
    {
      "risk": "Budget overruns on complex stories requiring many iterations",
      "mitigation": "Per-story budget enforcement with warnings at 80%, pause at 100%, budget allocation configurable"
    },
    {
      "risk": "Textual framework learning curve affecting UI development timeline",
      "mitigation": "Start with simple screens, iterate based on user feedback, prioritize functionality over polish initially"
    },
    {
      "risk": "Session state corruption during long-running executions",
      "mitigation": "Atomic state writes, timestamp-based locking, stale state detection, reset mechanism"
    },
    {
      "risk": "LLM hallucinations in generated artifacts (PRD, execution plan)",
      "mitigation": "Pydantic validation enforces schema compliance, user review before execution, phase gates for validation"
    },
    {
      "risk": "Dependency resolution complexity in execution plan generation",
      "mitigation": "Conservative dependency tracking, validation of dependency graph for cycles, manual override capability"
    }
  ]
}